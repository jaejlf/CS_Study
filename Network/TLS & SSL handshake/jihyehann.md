# π’΅ TLS/SSL HandShake


TLS/SSL HandShake λ€, `HTTPS` μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„ ν†µμ‹  μ „ SSL μΈμ¦μ„λ΅ μ‹ λΆ°μ„± μ—¬λ¶€λ¥Ό νλ‹¨ν•κΈ° μ„ν•΄ μ—°κ²°ν•λ” λ°©μ‹μ„ λ§ν•λ‹¤.

<br/>

> #### π”– TLS ν•Έλ“μ…°μ΄ν¬μ™€ SSL ν•Έλ“μ…°μ΄ν¬
> `SSL(Secure Sockets Layer)` μ€ μ›λ HTTPμ©μΌλ΅ κ°λ°λ μ•”νΈν™” ν”„λ΅ν† μ½λ΅, μ¤λ μ „μ— `TLS(Transport Layer Security)` λ΅ λ€μ²΄λμ—λ‹¤. 
> 
> SSL ν•Έλ“μ…°μ΄ν¬λ” "SSL"μ΄λΌλ” μ΄λ¦„μ΄ μ•„μ§ λ„λ¦¬ μ‚¬μ©λκ³  μμ§€λ§, μ΄μ λ” TLS ν•Έλ“μ…°μ΄ν¬λ΅ λ¶λ¦°λ‹¤.

<br/>

## TLS HandShakeλ” μ–Έμ  λ°μƒν• κΉ?

TLS ν•Έλ“μ…°μ΄ν¬λ” μ‚¬μ©μκ°€ `HTTPS`λ¥Ό ν†µν•΄ μ›Ή μ‚¬μ΄νΈλ¥Ό νƒμƒ‰ν•κ³  λΈλΌμ°μ €κ°€ μ²μ ν•΄λ‹Ή μ›Ή μ‚¬μ΄νΈμ μ›λ³Έ μ„λ²„λ¥Ό μΏΌλ¦¬ν•κΈ° μ‹μ‘ν•  λ•λ§λ‹¤ λ°μƒν•λ‹¤. 

λ‹¤λ¥Έ ν†µμ‹ μ΄ API νΈμ¶ λ° HTTPSλ¥Ό ν†µν• DNS μΏΌλ¦¬λ¥Ό ν¬ν•¨ν•λ” HTTPSλ¥Ό μ‚¬μ©ν•  λ•μ—λ„ ν•­μƒ TLS ν•Έλ“μ…°μ΄ν¬κ°€ λ°μƒν•λ‹¤.

TLS ν•Έλ“μ…°μ΄ν¬λ” **TCP μ—°κ²°μ΄ TCP ν•Έλ“μ…°μ΄ν¬λ¥Ό ν†µν•΄ μ—΄λ¦° ν›„**μ— λ°μƒν•λ‹¤.

<br/>

## TSL HandShake μ§„ν–‰ μμ„

![](https://velog.velcdn.com/images/wisdom-one/post/32e6d97d-b3ac-4728-92bc-b2444e06286c/image.png)

TLS ν•Έλ“μ…°μ΄ν¬μ μ •ν™•ν• λ‹¨κ³„λ” μ‚¬μ©λλ” ν‚¤ κµν™ μ•κ³ λ¦¬μ¦μ μ ν•κ³Ό μ»¤λ®¤λ‹μΌ€μ΄μ… μ–‘μΈ΅μ—μ„ λ¨λ‘ μ§€μ›ν•λ” μ•”νΈ μ ν’κµ°μ μ ν•μ— λ”°λΌ λ‹¬λΌμ§„λ‹¤.

λ€λ¶€λ¶„ `RSA ν‚¤ κµν™ μ•κ³ λ¦¬μ¦`μ΄ μ‚¬μ©λλ©° κ·Έ μ›λ¦¬λ” λ‹¤μκ³Ό κ°™λ‹¤.


1. **client hello λ©”μ‹μ§€** <br/>
ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„λ΅ "hello" λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•λ©΄μ„ ν•Έλ“μ…°μ΄ν¬λ¥Ό μ‹μ‘ν•λ‹¤. <br/>
μ΄ λ©”μ‹μ§€μ—λ” ν΄λΌμ΄μ–ΈνΈκ°€ μ§€μ›ν•λ” `TLS λ²„μ „`, `μ§€μ›λλ” μ•”νΈ μ ν’κµ°`, κ·Έλ¦¬κ³  `client random` λΌκ³  ν•λ” λ¬΄μ‘μ„ λ°”μ΄νΈ λ¬Έμμ—΄μ΄ ν¬ν•¨λλ‹¤.

2. **server hello λ©”μ‹μ§€** <br/>
ν΄λΌμ΄μ–ΈνΈ ν—¬λ΅ λ©”μ‹μ§€μ— λ€ν• μ‘λ‹µμΌλ΅ μ„λ²„κ°€ μ„λ²„μ `SSL μΈμ¦μ„`, μ„λ²„μ—μ„ μ„ νƒν• `μ•”νΈ μ ν’κµ°`, κ·Έλ¦¬κ³  μ„λ²„μ—μ„ μƒμ„±ν• λ λ‹¤λ¥Έ λ¬΄μ‘μ„ λ°”μ΄νΈ λ¬Έμμ—΄μΈ `server random` λ¥Ό ν¬ν•¨ν•λ” λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•λ‹¤.

3. **μΈμ¦** <br/>
ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ SSL μΈμ¦μ„λ¥Ό μΈμ¦μ„ λ°ν–‰ κΈ°κ΄€μ„ ν†µν•΄ κ²€μ¦ν•λ‹¤. <br/>
μ΄λ¥Ό ν†µν•΄ μ„λ²„κ°€ μΈμ¦μ„μ— λ…μ‹λ μ„λ²„μΈμ§€, κ·Έλ¦¬κ³  ν΄λΌμ΄μ–ΈνΈκ°€ μƒνΈμ‘μ© μ¤‘μΈ μ„λ²„κ°€ μ‹¤μ  ν•΄λ‹Ή λ„λ©”μΈμ μ†μ μμΈμ§€λ¥Ό ν™•μΈν•λ‹¤.

4. **μλΉ„ λ§μ¤ν„° μ•”νΈ (premaster secret)** <br/>
ν΄λΌμ΄μ–ΈνΈκ°€ "premaster secret"λΌκ³  ν•λ” λ¬΄μ‘μ„ λ°”μ΄νΈ λ¬Έμμ—΄μ„ ν•λ‚ λ” μ „μ†΅ν•λ‹¤. <br/>
μλΉ„ λ§μ¤ν„° μ•”νΈλ” `κ³µκ° ν‚¤` λ΅ μ•”νΈν™”λμ–΄ μμΌλ©°, μ„λ²„κ°€ `κ°μΈ ν‚¤` λ΅λ§ ν•΄λ…ν•  μ μλ‹¤. (ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ SSL μΈμ¦μ„λ¥Ό ν†µν•΄ κ³µκ°ν‚¤λ¥Ό λ°›λ”λ‹¤.)

5. **κ°μΈ ν‚¤ μ‚¬μ©** <br/>
μ„λ²„κ°€ μλΉ„ λ§μ¤ν„° μ•”νΈλ¥Ό ν•΄λ…ν•λ‹¤.

6. **μ„Έμ… ν‚¤ μƒμ„±** <br/>
ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ λ¨λ‘ client random, server random, premaster secret μ„ μ΄μ©ν•΄ μ„Έμ… ν‚¤λ¥Ό μƒμ„±ν•λ‹¤. <br/>
μ΄λ• λ¨λ‘ κ°™μ€ κ²°κ³Όκ°€ λ‚μ™€μ•Ό ν•λ‹¤.

7. **ν΄λΌμ΄μ–ΈνΈ μ¤€λΉ„ μ™„λ£** <br/>
ν΄λΌμ΄μ–ΈνΈκ°€ μ„Έμ… ν‚¤λ΅ μ•”νΈν™”λ "finished" λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•©λ‹λ‹¤.

8. **μ„λ²„ μ¤€λΉ„ μ™„λ£** <br/>
μ„λ²„κ°€ μ„Έμ… ν‚¤λ΅ μ•”νΈν™”λ "finished" λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•©λ‹λ‹¤.

9. **μ•μ „ν• λ€μΉ­ μ•”νΈν™” μ„±κ³µ** <br/>
ν•Έλ“μ…°μ΄ν¬κ°€ μ™„λ£λκ³ , μ„Έμ… ν‚¤λ¥Ό μ΄μ©ν•΄ ν†µμ‹ μ΄ κ³„μ† μ§„ν–‰λλ‹¤.

<br/>

## π”– μ°Έκ³ 
[TLS ν•Έλ“μ…°μ΄ν¬μ μ›λ¦¬](https://www.cloudflare.com/ko-kr/learning/ssl/what-happens-in-a-tls-handshake/)
